<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡¶™‡ßá‡¶ü‡¶ø‡¶ï‡ßç‡¶Ø‡¶æ‡¶∂ ‡¶∏‡ßç‡¶ü‡ßá‡¶ü‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡ß®‡ß¶‡ß®‡ß´</title>
    <link rel="stylesheet" href="https://fonts.maateen.me/kalpurush/font.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Kalpurush', 'SolaimanLipi', Arial, sans-serif;
            background: #f5f5f5;
            margin: 0;
        }
        
        .main-wrapper { 
            max-width: 1400px;
            margin: 20px auto;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            background: white;
            display: flex;
            min-height: 90vh; 
            border-radius: 8px;
            overflow: hidden;
        }

        .sidebar {
            width: 250px;
            background-color: #3A358E; 
            color: white;
            padding: 20px 0;
            flex-shrink: 0;
        }
        
       
.sidebar-header {
    font-size: 22px;  /* Increased from 18px */
    font-weight: bold;
    text-align: center;
    margin-bottom: 25px;  /* Increased from 20px */
    padding-bottom: 15px;  /* Increased from 10px */
    padding-top: 10px;  /* Added vertical padding */
    padding-left: 10px;  /* Added horizontal padding */
    padding-right: 10px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.2);
}
        .sidebar ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .sidebar ul li a {
            display: block;
            padding: 12px 20px;
            color: white;
            text-decoration: none;
            transition: background-color 0.3s, padding-left 0.3s;
            font-weight: bold;
        }
        .sidebar ul li a:hover,
        .sidebar ul li a.active {
            background-color: #2c286e; 
            border-left: 5px solid #1abc9c;
            padding-left: 25px;
        }

        .main-content {
            flex-grow: 1;
            padding: 20px;
            overflow-y: auto;
            max-height: 90vh;
        }
        
        .header {
            text-align: center;
            margin-bottom: 15px;
            border-bottom: 3px solid #3A358E; 
            padding-bottom: 15px;
            display: flex; 
            flex-direction: column; 
            align-items: center; 
        }

        .header .logo {
            max-width: 250px;
            height: auto;
            margin-bottom: 8px;
            margin-top: 8px;
        }

        .header h2 {
            font-size: 18px;
            color: #3A358E;
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .office-details {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 8px 0;
            max-width: 800px;
            margin: 0 auto;
            gap: 20px;
            flex-wrap: wrap;
        }

        .detail-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .detail-item label {
            font-weight: bold;
            white-space: nowrap;
            font-size: 13px;
        }
        
        .detail-item input {
            padding: 6px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-family: 'Kalpurush', 'SolaimanLipi', Arial, sans-serif;
            font-size: 12px;
            width: 120px;
            background-color: #f0f8ff;
            border-color: #a0c4ff;
        }

        .expense-section {
            margin-bottom: 12px;
            border: 1px solid #ddd;
            padding: 12px;
            background-color: #f9f9f9;
            border-radius: 6px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }

        .expense-section h3 {
            background-color: #3A358E; 
            color: white;
            padding: 8px 12px;
            margin: -12px -12px 10px -12px;
            font-size: 14px;
            border-top-left-radius: 6px;
            border-top-right-radius: 6px;
        }
        
        .expense-section h4 {
            font-size: 13px;
            font-weight: bold;
            margin-bottom: 8px;
            border-bottom: 1px solid #ddd; 
            padding-bottom: 4px;
            margin-top: 10px;
        }
        .expense-section h4:first-of-type {
            margin-top: 0;
        }

        .entry-row {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 10px; 
            padding: 8px;
            border: 1px solid #eee;
            background: #fff;
            border-radius: 4px;
            flex-wrap: wrap;
        }
        
        .entry-row label {
            flex-shrink: 0;
            font-weight: bold;
            font-size: 12px;
            width: 100px;
            text-align: right;
        }

        .entry-row .amount-label {
             font-weight: bold;
             width: auto;
             text-align: left;
             font-size: 12px;
        }
        
        .entry-row select {
            flex-grow: 1; 
            padding: 6px;
            min-width: 120px;
            font-family: 'Kalpurush', 'SolaimanLipi', Arial, sans-serif;
            font-size: 12px;
            background-color: #f0f8ff;
            border: 1px solid #a0c4ff;
        }

        .entry-row input[type="number"] {
            width: 80px;
            padding: 6px;
            text-align: right;
            font-family: 'Kalpurush', 'SolaimanLipi', Arial, sans-serif;
            font-size: 12px;
            background-color: #f0f8ff;
            border: 1px solid #a0c4ff;
        }
        
        .entry-row input[type="text"] {
            padding: 6px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-family: 'Kalpurush', 'SolaimanLipi', Arial, sans-serif;
            font-size: 12px;
            background-color: #f0f8ff;
            border-color: #a0c4ff;
        }

        .entry-row button {
            flex-shrink: 0;
            padding: 6px 10px;
            background-color: #1abc9c;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            white-space: nowrap;
            transition: background-color 0.3s;
            font-size: 11px;
            font-weight: bold;
        }

        .entry-row button:hover {
            background-color: #16a085;
        }

        .manpower-row {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 10px;
            padding: 8px;
            border: 1px solid #eee;
            background: #fff;
            border-radius: 4px;
            flex-wrap: wrap;
        }
        
        .manpower-row label {
            flex-shrink: 0;
            font-weight: bold;
            width: 120px;
            text-align: left;
            font-size: 12px;
        }
        
        .manpower-row input[type="text"] {
            padding: 6px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-family: 'Kalpurush', 'SolaimanLipi', Arial, sans-serif;
            font-size: 12px;
            background-color: #f0f8ff;
            border-color: #a0c4ff;
        }

        .manpower-row input#manpower-code {
            width: 100px;
            flex-shrink: 0;
        }
        .manpower-row input#manpower-name {
            flex-grow: 1;
            min-width: 120px;
            background-color: #f0f0f0;
        }
        
        .manpower-row button {
            padding: 6px 10px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            flex-shrink: 0;
            transition: background-color 0.3s;
            font-size: 11px;
            font-weight: bold;
        }

        .manpower-row button:hover {
            background-color: #2980b9;
        }
        
        .footer {
            margin-top: 15px;
            padding-top: 10px;
            border-top: 2px solid #3A358E; 
            display: flex;
            justify-content: space-between; 
            font-size: 10px;
            color: #555;
        }

        #log-section {
            margin: 15px auto;
            padding: 12px;
            background-color: #fff;
            border: 1px solid #ddd;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
            border-radius: 6px;
        }

        #log-section h3 {
            background-color: #3A358E; 
            color: white;
            padding: 8px 12px;
            margin: -12px -12px 10px -12px;
            font-size: 14px;
            text-align: center;
            border-top-left-radius: 6px;
            border-top-right-radius: 6px;
        }

        #log-section input {
            width: 100%;
            padding: 6px;
            margin-bottom: 8px;
            border: 1px solid #a0c4ff;
            border-radius: 4px;
            font-family: 'Kalpurush', 'SolaimanLipi', Arial, sans-serif;
            font-size: 12px;
            background-color: #f0f8ff;
        }

        #expense-log {
            list-style: none;
            padding: 0;
            margin: 0;
            max-height: 300px;
            overflow-y: auto;
        }

        #expense-log li {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px;
            border-bottom: 1px dotted #ddd;
            font-size: 12px;
            transition: background-color 0.3s;
            flex-wrap: wrap;
            gap: 8px;
        }

        #expense-log li:hover {
            background-color: #f5f5f5;
        }

        #expense-log li:last-child {
            border-bottom: none;
        }

        .log-details {
            flex-grow: 1;
            font-weight: bold;
            font-size: 12px;
        }

        .remove-btn {
            background-color: #e74c3c;
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 10px;
            transition: background-color 0.3s;
        }

        .remove-btn:hover {
            background-color: #c0392b;
        }

        .edit-btn {
            background-color: #27ae60;
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 10px;
            transition: background-color 0.3s;
        }

        .edit-btn:hover {
            background-color: #219a52;
        }

        .log-empty-message {
            text-align: center;
            color: #888;
            padding: 10px;
            font-size: 12px;
        }

        .clear-all-btn {
            background-color: #e74c3c;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 11px;
            margin-bottom: 8px;
            display: block;
            margin: 0 auto 8px auto;
            transition: background-color 0.3s;
            font-weight: bold;
        }

        .clear-all-btn:hover {
            background-color: #c0392b;
        }

        input, select, textarea, button {
            font-family: 'Kalpurush', 'SolaimanLipi', Arial, sans-serif !important;
        }

        /* --- LAYOUT --- */
        .forms-and-log-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 15px;
        }

        .forms-column-1, .forms-column-2 {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .forms-column-1 .expense-section,
        .forms-column-2 .expense-section {
            margin: 0;
        }

        .development-section .form-group {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
            padding: 8px;
            background: #fff;
            border: 1px solid #eee;
            border-radius: 4px;
            flex-wrap: wrap;
        }

        .development-section .form-group label {
            font-weight: bold;
            min-width: 90px;
            text-align: right;
            flex-shrink: 0;
            font-size: 12px;
        }

        .development-section .form-group input,
        .development-section .form-group select {
            padding: 6px;
            min-width: 80px;
            flex-grow: 1;
            font-size: 12px;
            background-color: #f0f8ff;
            border: 1px solid #a0c4ff;
            border-radius: 4px;
        }

        .development-section .form-group button {
            flex-shrink: 0;
            padding: 6px 10px;
            background-color: #1abc9c;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
            font-size: 11px;
            font-weight: bold;
        }

        .development-section .form-group button:hover {
            background-color: #16a085;
        }

        .development-section .button-row {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-top: 8px;
        }

        .development-section .button-row button {
            padding: 8px 15px;
            font-size: 12px;
        }

        .section-divider {
            margin-top: 12px;
            padding-top: 10px;
            border-top: 1px solid #e0e0e0;
        }

        @media (max-width: 1200px) {
            .forms-and-log-container {
                grid-template-columns: 1fr;
            }
        }

    </style>
</head>
<body>
    <div class="main-wrapper">
        <nav class="sidebar">
            <a class="sidebar-header" href="data entry.html" style="text-decoration: none; display: block; color: white;">
                üè† ‡¶π‡ßã‡¶Æ
            </a>
            <ul>
                <li><a href="data entry.html" class="active">üìù ‡¶°‡ßá‡¶ü‡¶æ ‡¶è‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶ø</a></li> <li><a href="commission_calculation.html">üßÆ ‡¶ï‡¶Æ‡¶ø‡¶∂‡¶® ‡¶ó‡¶£‡¶®‡¶æ</a></li>
                <li><a href="pettycash-statement.html">üí∞ ‡¶™‡ßá‡¶ü‡¶ø‡¶ï‡ßç‡¶Ø‡¶æ‡¶∂ ‡¶∏‡ßç‡¶ü‡ßá‡¶ü‡¶Æ‡ßá‡¶®‡ßç‡¶ü‡¶∏‡¶Æ‡ßÇ‡¶π</a></li>
                <li><a href="Commission Statement.html">üìä ‡¶ï‡¶Æ‡¶ø‡¶∂‡¶® ‡¶∏‡ßç‡¶ü‡ßá‡¶ü‡¶Æ‡ßá‡¶®‡ßç‡¶ü</a></li>
                <li><a href="Manpower List (Editable).html">üë• ‡¶ú‡¶®‡¶¨‡¶≤ ‡¶ì ‡¶ñ‡¶∞‡¶ö‡ßá‡¶∞ ‡¶ñ‡¶æ‡¶§</a></li>
                <li><a href="archive.html">üì¶ ‡¶Ü‡¶∞‡ßç‡¶ï‡¶æ‡¶á‡¶≠</a></li>
                <li><a href="data management.html">‚öôÔ∏è ‡¶°‡¶æ‡¶ü‡¶æ ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶ú‡¶Æ‡ßá‡¶®‡ßç‡¶ü</a></li>
		<li><a href="edit-archive.html">‚úèÔ∏è ‡¶Ü‡¶∞‡ßç‡¶ï‡¶æ‡¶á‡¶≠ ‡¶∏‡¶Æ‡ßç‡¶™‡¶æ‡¶¶‡¶®‡¶æ</a></li>
            </ul>
        </nav>

        <div class="main-content">
            <div class="header">
                <img src="Logo.png" alt="‡¶ú‡ßÄ‡¶¨‡¶® ‡¶¨‡ßÄ‡¶Æ‡¶æ ‡¶ï‡¶∞‡ßç‡¶™‡ßã‡¶∞‡ßá‡¶∂‡¶® Logo" class="logo">
                <h2>‡¶™‡ßá‡¶ü‡¶ø‡¶ï‡ßç‡¶Ø‡¶æ‡¶∂ ‡¶∏‡ßç‡¶ü‡ßá‡¶ü‡¶Æ‡ßá‡¶®‡ßç‡¶ü</h2>
                <div class="office-details">
                    <div class="detail-item">
                        <label>‡¶Ö‡¶´‡¶ø‡¶∏ ‡¶ï‡ßã‡¶°:</label>
                        <input type="text" value="‡•¶‡•¶‡ßß‡ß¨" style="width: 80px;">
                    </div>
                    <div class="detail-item">
                        <label>‡¶Ö‡¶´‡¶ø‡¶∏‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ:</label>
                        <input type="text" value="‡¶∏‡ßá‡¶≤‡¶∏ ‡¶Ö‡¶´‡¶ø‡¶∏-‡ßß‡ß¨, ‡¶®‡¶æ‡¶∞‡¶æ‡¶Ø‡¶º‡¶£‡¶ó‡¶û‡ßç‡¶ú" style="width: 180px;">
                    </div>
                </div>
            </div>
            
            <div class="forms-and-log-container">
                
                <div class="forms-column-1">
                    <div class="expense-section">
                        <h3>‡¶ñ‡¶∞‡¶ö‡ßá‡¶∞ ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ ‡¶ì ‡¶ß‡¶∞‡¶®</h3>
                        <div class="entry-row">
                            <div style="display: flex; align-items: center; gap: 8px; flex: 1; min-width: 200px;">
                                <label for="expense-date" style="width: 60px; text-align: left; font-weight: bold; font-size: 12px;">‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ:</label>
                                <input type="text" id="expense-date" placeholder="dd/mm/yy" maxlength="8" style="width: 80px; flex: none;">
                            </div>
                            <div style="display: flex; align-items: center; gap: 8px; flex: 1; min-width: 180px;">
                                <label for="payment-type" style="width: auto; text-align: left; font-weight: bold; font-size: 12px;">‡¶ß‡¶∞‡¶®:</label>
                                <select id="payment-type" style="flex-grow: 1; min-width: 80px;">
                                    <option value="" disabled selected>‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</option>
                                    <option value="bank">‡¶¨‡ßç‡¶Ø‡¶æ‡¶Ç‡¶ï</option>
                                    <option value="cash">‡¶ï‡ßç‡¶Ø‡¶æ‡¶∂</option>
                                </select>
                            </div>
                        </div>
                        <div class="manpower-row">
                            <label for="manpower-code">‡¶ï‡ßã‡¶°:</label>
                            <input type="text" id="manpower-code" placeholder="‡¶Ø‡ßá‡¶Æ‡¶®: 2504" style="width: 90px;">
                            <input type="text" id="manpower-name" placeholder="‡¶®‡¶æ‡¶Æ" readonly style="flex-grow: 1;">
                            <button onclick="fetchManpowerName()">‡¶ñ‡ßÅ‡¶Å‡¶ú‡ßÅ‡¶®</button>
                        </div>
                    </div>

                    <div class="expense-section">
                        <h3>‡¶Ö‡¶´‡¶ø‡¶∏ ‡¶ñ‡¶∞‡¶ö</h3>
                        <div class="entry-row">
                            <label for="office-expenses" style="width: 90px;">‡¶¨‡¶ø‡¶≠‡¶æ‡¶ó:</label>
                            <select id="office-expenses" style="flex-grow: 1; min-width: 120px;">
                                <option value="" disabled selected>‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</option>
                                <option value="‡¶ï‡¶∞‡ßç‡¶Æ‡¶ö‡¶æ‡¶∞‡ßÄ ‡¶¨‡ßá‡¶§‡¶® (‡¶Ö‡¶´‡¶ø‡¶∏)">‡¶ï‡¶∞‡ßç‡¶Æ‡¶ö‡¶æ‡¶∞‡ßÄ ‡¶¨‡ßá‡¶§‡¶® (‡¶Ö‡¶´‡¶ø‡¶∏)</option>
                                <option value="‡¶â‡ßé‡¶∏‡¶¨ ‡¶¨‡ßã‡¶®‡¶æ‡¶∏ (‡¶Ö‡¶´‡¶ø‡¶∏)">‡¶â‡ßé‡¶∏‡¶¨ ‡¶¨‡ßã‡¶®‡¶æ‡¶∏ (‡¶Ö‡¶´‡¶ø‡¶∏)</option>
                                <option value="‡¶≤‡¶æ‡¶û‡ßç‡¶ö‡¶≠‡¶æ‡¶§‡¶æ (‡¶Ö‡¶´‡¶ø‡¶∏)">‡¶≤‡¶æ‡¶û‡ßç‡¶ö‡¶≠‡¶æ‡¶§‡¶æ (‡¶Ö‡¶´‡¶ø‡¶∏)</option>
                                <option value="‡¶â‡ßé‡¶∏‡¶æ‡¶π ‡¶¨‡ßã‡¶®‡¶æ‡¶∏ (‡¶Ö‡¶´‡¶ø‡¶∏)">‡¶â‡ßé‡¶∏‡¶æ‡¶π ‡¶¨‡ßã‡¶®‡¶æ‡¶∏ (‡¶Ö‡¶´‡¶ø‡¶∏)</option>
                                <option value="‡¶¨‡ßà‡¶∂‡¶æ‡¶ñ‡ßÄ ‡¶≠‡¶æ‡¶§‡¶æ (‡¶Ö‡¶´‡¶ø‡¶∏)">‡¶¨‡ßà‡¶∂‡¶æ‡¶ñ‡ßÄ ‡¶≠‡¶æ‡¶§‡¶æ (‡¶Ö‡¶´‡¶ø‡¶∏)</option>
                                <option value="‡¶∂‡ßç‡¶∞‡¶æ‡¶®‡ßç‡¶§‡¶ø ‡¶ì ‡¶¨‡¶ø‡¶®‡ßã‡¶¶‡¶® ‡¶≠‡¶æ‡¶§‡¶æ">‡¶∂‡ßç‡¶∞‡¶æ‡¶®‡ßç‡¶§‡¶ø ‡¶ì ‡¶¨‡¶ø‡¶®‡ßã‡¶¶‡¶® ‡¶≠‡¶æ‡¶§‡¶æ</option>
                                <option value="‡¶ï‡ßç‡¶Ø‡¶æ‡¶∂ ‡¶è‡¶≤‡¶æ‡¶â‡¶®‡ßç‡¶∏">‡¶ï‡ßç‡¶Ø‡¶æ‡¶∂ ‡¶è‡¶≤‡¶æ‡¶â‡¶®‡ßç‡¶∏</option>
                                <option value="‡¶≠‡ßç‡¶∞‡¶Æ‡¶£ ‡¶ì ‡¶Ø‡¶æ‡¶§‡¶æ‡¶Ø‡¶º‡¶æ‡¶§ ‡¶ñ‡¶∞‡¶ö">‡¶≠‡ßç‡¶∞‡¶Æ‡¶£ ‡¶ì ‡¶Ø‡¶æ‡¶§‡¶æ‡¶Ø‡¶º‡¶æ‡¶§ ‡¶ñ‡¶∞‡¶ö</option>
				<option value="‡¶ö‡¶ø‡¶ï‡¶ø‡ßé‡¶∏‡¶æ ‡¶ñ‡¶∞‡¶ö (‡¶Ö‡¶´‡¶ø‡¶∏)">‡¶ö‡¶ø‡¶ï‡¶ø‡ßé‡¶∏‡¶æ ‡¶ñ‡¶∞‡¶ö (‡¶Ö‡¶´‡¶ø‡¶∏)</option>
                            </select>
                            <label class="amount-label">‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£:</label>
                            <input type="number" id="amount-office" min="0" placeholder="‡¶ü‡¶æ‡¶ï‡¶æ" style="width: 70px;">
                            <button onclick="saveEntry('office-expenses', 'amount-office')">‡¶∏‡ßá‡¶≠</button>
                        </div>
                    </div>

                    <div class="expense-section">
                        <h3>‡¶¶‡¶æ‡¶™‡ßç‡¶§‡¶∞‡¶ø‡¶ï ‡¶ñ‡¶∞‡¶ö</h3>
                        <div class="entry-row">
                            <label for="official-expenses" style="width: 90px;">‡¶ß‡¶∞‡¶®:</label>
                            <select id="official-expenses" style="flex-grow: 1; min-width: 120px;">
                                <option value="" disabled selected>‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</option>
                                <option value="‡¶™‡ßá‡¶ü‡¶ø‡¶ï‡ßç‡¶Ø‡¶æ‡¶∂">‡¶™‡ßá‡¶ü‡¶ø‡¶ï‡ßç‡¶Ø‡¶æ‡¶∂</option>
                                <option value="‡¶ü‡ßá‡¶≤‡¶ø‡¶´‡ßã‡¶® ‡¶¨‡¶ø‡¶≤">‡¶ü‡ßá‡¶≤‡¶ø‡¶´‡ßã‡¶® ‡¶¨‡¶ø‡¶≤</option>
                                <option value="‡¶Æ‡ßÅ‡¶¶‡ßç‡¶∞‡¶£ ‡¶ì ‡¶Æ‡¶£‡¶ø‡¶π‡¶æ‡¶∞‡¶ø ‡¶ñ‡¶∞‡¶ö">‡¶Æ‡ßÅ‡¶¶‡ßç‡¶∞‡¶£ ‡¶ì ‡¶Æ‡¶£‡¶ø‡¶π‡¶æ‡¶∞‡¶ø ‡¶ñ‡¶∞‡¶ö</option>
                                <option value="‡¶∞‡¶æ‡¶ú‡¶∏‡ßç‡¶¨ ‡¶ü‡¶ø‡¶ï‡ßá‡¶ü">‡¶∞‡¶æ‡¶ú‡¶∏‡ßç‡¶¨ ‡¶ü‡¶ø‡¶ï‡ßá‡¶ü</option>
                                <option value="‡¶á‡¶®‡ßç‡¶ü‡¶æ‡¶∞‡¶®‡ßá‡¶ü ‡¶¨‡¶ø‡¶≤">‡¶á‡¶®‡ßç‡¶ü‡¶æ‡¶∞‡¶®‡ßá‡¶ü ‡¶¨‡¶ø‡¶≤</option>
                                <option value="‡¶∏‡¶æ‡¶ß‡¶æ‡¶∞‡¶£ ‡¶ñ‡¶∞‡¶ö">‡¶∏‡¶æ‡¶ß‡¶æ‡¶∞‡¶£ ‡¶ñ‡¶∞‡¶ö</option>
                                <option value="‡¶™‡¶§‡ßç‡¶∞‡¶ø‡¶ï‡¶æ ‡¶¨‡¶ø‡¶≤">‡¶™‡¶§‡ßç‡¶∞‡¶ø‡¶ï‡¶æ ‡¶¨‡¶ø‡¶≤</option>
                                <option value="‡¶¨‡¶ø‡¶¨‡¶ø‡¶ß ‡¶¨‡ßç‡¶Ø‡¶Ø‡¶º">‡¶¨‡¶ø‡¶¨‡¶ø‡¶ß ‡¶¨‡ßç‡¶Ø‡¶Ø‡¶º</option>
                                <option value="‡¶Ü‡¶∏‡¶¨‡¶æ‡¶¨‡¶™‡¶§‡ßç‡¶∞ ‡¶ï‡ßç‡¶∞‡¶Ø‡¶º">‡¶Ü‡¶∏‡¶¨‡¶æ‡¶¨‡¶™‡¶§‡ßç‡¶∞ ‡¶ï‡ßç‡¶∞‡¶Ø‡¶º</option>
				<option value="‡¶°‡¶æ‡¶ï ‡¶ì ‡¶§‡¶æ‡¶∞ ‡¶ñ‡¶∞‡¶ö">‡¶°‡¶æ‡¶ï ‡¶ì ‡¶§‡¶æ‡¶∞ ‡¶ñ‡¶∞‡¶ö</option>
				<option value="‡¶Ö‡¶´‡¶ø‡¶∏ ‡¶≠‡¶æ‡¶°‡¶º‡¶æ">‡¶Ö‡¶´‡¶ø‡¶∏ ‡¶≠‡¶æ‡¶°‡¶º‡¶æ</option>
				<option value="‡¶¶‡ßà‡¶É‡¶Æ‡¶É‡¶≠‡¶ø‡¶É ‡¶ï‡¶∞‡ßç‡¶Æ‡¶ö‡¶æ‡¶∞‡ßÄ‡¶∞ ‡¶¨‡¶ø‡¶≤">‡¶¶‡ßà‡¶É‡¶Æ‡¶É‡¶≠‡¶ø‡¶É ‡¶ï‡¶∞‡ßç‡¶Æ‡¶ö‡¶æ‡¶∞‡ßÄ‡¶∞ ‡¶¨‡¶ø‡¶≤</option>
                            </select>
                            <label class="amount-label">‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£:</label>
                            <input type="number" id="amount-official" min="0" placeholder="‡¶ü‡¶æ‡¶ï‡¶æ" style="width: 70px;">
                            <button onclick="saveEntry('official-expenses', 'amount-official')">‡¶∏‡ßá‡¶≠</button>
                        </div>
                    </div>

                </div> <div class="forms-column-2">
                    
                    <div class="expense-section development-section">
                        <h3>‡¶â‡¶®‡ßç‡¶®‡¶Ø‡¶º‡¶® ‡¶¨‡¶ø‡¶≠‡¶æ‡¶ó</h3>
                        
                        <h4>‡¶è‡¶ú‡ßá‡¶®‡ßç‡¶ü ‡¶ï‡¶Æ‡¶ø‡¶∂‡¶®</h4>
                        
                        <div class="form-group">
                            <label for="commission-first-year">‡ßß‡¶Æ ‡¶¨‡¶∞‡ßç‡¶∑ ‡¶ï‡¶Æ‡¶ø‡¶∂‡¶®:</label>
                            <input type="hidden" id="commission-first-year-select" value="‡ßß‡¶Æ ‡¶¨‡¶∞‡ßç‡¶∑ ‡¶ï‡¶Æ‡¶ø‡¶∂‡¶®">
                            <input type="number" id="amount-first-year" min="0" placeholder="‡¶ü‡¶æ‡¶ï‡¶æ" style="width: 70px;">
                            <input type="text" id="bill-no-first-year" placeholder="‡¶¨‡¶ø‡¶≤ ‡¶®‡¶Ç" style="width: 70px;">
                            <input type="text" id="bill-date-first-year" placeholder="dd/mm/yy" maxlength="8" style="width: 70px;">
                        </div>

                        <div class="form-group">
                            <label for="commission-renewal">‡¶®‡¶¨‡¶æ‡¶Ø‡¶º‡¶® ‡¶ï‡¶Æ‡¶ø‡¶∂‡¶®:</label>
                            <input type="hidden" id="commission-renewal-select" value="‡¶®‡¶¨‡¶æ‡¶Ø‡¶º‡¶® ‡¶ï‡¶Æ‡¶ø‡¶∂‡¶®">
                            <input type="number" id="amount-renewal" min="0" placeholder="‡¶ü‡¶æ‡¶ï‡¶æ" style="width: 70px;">
                            <input type="text" id="bill-no-renewal" placeholder="‡¶¨‡¶ø‡¶≤ ‡¶®‡¶Ç" style="width: 70px;">
                            <input type="text" id="bill-date-renewal" placeholder="dd/mm/yy" maxlength="8" style="width: 70px;">
                        </div>
                        
                        <div class="button-row">
                            <button onclick="saveCommissionEntries()">‡¶∏‡ßá‡¶≠ ‡¶è‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶ø</button>
                        </div>
                        
                        <div class="section-divider">
                            <h4>‡¶ï‡¶∞‡ßç‡¶Æ‡¶ï‡¶∞‡ßç‡¶§‡¶æ</h4>
                            
                            <div class="form-group">
                                <label for="development-staff" style="width: 100%; text-align: left;">‡¶ñ‡¶∞‡¶ö‡ßá‡¶∞ ‡¶ß‡¶∞‡¶®:</label>
                            </div>
                            <div class="form-group">
                                <select id="development-staff" style="flex-grow: 1; min-width: 120px;">
                                    <option value="" disabled selected>‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</option>
                                    <option value="‡¶™‡ßç‡¶∞‡ßã‡¶°‡¶æ‡¶ï‡¶∂‡¶® ‡¶¨‡ßã‡¶®‡¶æ‡¶∏">‡¶™‡ßç‡¶∞‡ßã‡¶°‡¶æ‡¶ï‡¶∂‡¶® ‡¶¨‡ßã‡¶®‡¶æ‡¶∏</option>
                                    <option value="‡¶ï‡¶∞‡ßç‡¶Æ‡¶ö‡¶æ‡¶∞‡ßÄ ‡¶¨‡ßá‡¶§‡¶® (‡¶â‡¶®‡ßç‡¶®‡¶Ø‡¶º‡¶®)">‡¶ï‡¶∞‡ßç‡¶Æ‡¶ö‡¶æ‡¶∞‡ßÄ ‡¶¨‡ßá‡¶§‡¶® (‡¶â‡¶®‡ßç‡¶®‡¶Ø‡¶º‡¶®)</option>
                                    <option value="‡¶â‡ßé‡¶∏‡¶¨ ‡¶¨‡ßã‡¶®‡¶æ‡¶∏ (‡¶â‡¶®‡ßç‡¶®‡¶Ø‡¶º‡¶®)">‡¶â‡ßé‡¶∏‡¶¨ ‡¶¨‡ßã‡¶®‡¶æ‡¶∏ (‡¶â‡¶®‡ßç‡¶®‡¶Ø‡¶º‡¶®)</option>
                                    <option value="‡¶â‡ßé‡¶∏‡¶æ‡¶π ‡¶¨‡ßã‡¶®‡¶æ‡¶∏ (‡¶â‡¶®‡ßç‡¶®‡¶Ø‡¶º‡¶®)">‡¶â‡ßé‡¶∏‡¶æ‡¶π ‡¶¨‡ßã‡¶®‡¶æ‡¶∏ (‡¶â‡¶®‡ßç‡¶®‡¶Ø‡¶º‡¶®)</option>
                                    <option value="‡¶¨‡ßà‡¶∂‡¶æ‡¶ñ‡ßÄ ‡¶≠‡¶æ‡¶§‡¶æ (‡¶â‡¶®‡ßç‡¶®‡¶Ø‡¶º‡¶®)">‡¶¨‡ßà‡¶∂‡¶æ‡¶ñ‡ßÄ ‡¶≠‡¶æ‡¶§‡¶æ (‡¶â‡¶®‡ßç‡¶®‡¶Ø‡¶º‡¶®)</option>
                                    <option value="‡¶°‡¶æ‡¶ï‡ßç‡¶§‡¶æ‡¶∞‡ßÄ ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ‡¶∞ ‡¶´‡¶ø">‡¶°‡¶æ‡¶ï‡ßç‡¶§‡¶æ‡¶∞‡ßÄ ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ‡¶∞ ‡¶´‡¶ø</option>
                                    <option value="‡¶≤‡¶æ‡¶û‡ßç‡¶ö‡¶≠‡¶æ‡¶§‡¶æ (‡¶â‡¶®‡ßç‡¶®‡¶Ø‡¶º‡¶®)">‡¶≤‡¶æ‡¶û‡ßç‡¶ö‡¶≠‡¶æ‡¶§‡¶æ (‡¶â‡¶®‡ßç‡¶®‡¶Ø‡¶º‡¶®)</option>
				    <option value="‡¶¨‡ßã‡¶®‡¶æ‡¶∏ ‡¶ï‡¶Æ‡¶ø‡¶∂‡¶®">‡¶¨‡ßã‡¶®‡¶æ‡¶∏ ‡¶ï‡¶Æ‡¶ø‡¶∂‡¶®</option>
                                </select>
                                <label class="amount-label">‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£:</label>
                                <input type="number" id="amount-staff" min="0" placeholder="‡¶ü‡¶æ‡¶ï‡¶æ" style="width: 70px;">
                                <button onclick="saveEntry('development-staff', 'amount-staff')">‡¶∏‡ßá‡¶≠</button>
                            </div>
                        </div>

                    </div> </div> </div> <div id="log-section">
                <h3>‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡¶æ ‡¶è‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶ø‡¶∞ ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ</h3>
                <input type="text" id="search-log" placeholder="‡¶Ö‡¶®‡ßÅ‡¶∏‡¶®‡ßç‡¶ß‡¶æ‡¶® ‡¶ï‡¶∞‡ßÅ‡¶® (‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ, ‡¶¨‡¶ø‡¶¨‡¶∞‡¶£, ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£)">
                <button class="clear-all-btn" onclick="clearAllEntries()">‡¶∏‡¶¨ ‡¶Æ‡ßÅ‡¶õ‡ßÅ‡¶®</button>
                <ul id="expense-log">
                    <li class="log-empty-message">‡¶ï‡ßã‡¶®‡ßã ‡¶è‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶ø ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡¶®‡¶ø‡•§</li>
                </ul>
            </div>

            <div class="footer">
                <span class="left-text">Designed & Developed By: Sifat Ahmed</span>
                <span class="right-text">All Right Reserved 2025</span>
            </div>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script>
    const EXPENSE_MAPPING = {
        '‡ßß‡¶Æ ‡¶¨‡¶∞‡ßç‡¶∑ ‡¶ï‡¶Æ‡¶ø‡¶∂‡¶®': '‡ßß‡¶Æ ‡¶¨‡¶∞‡ßç‡¶∑ ‡¶ï‡¶Æ‡¶ø‡¶∂‡¶®',
        '‡¶®‡¶¨‡¶æ‡¶Ø‡¶º‡¶® ‡¶ï‡¶Æ‡¶ø‡¶∂‡¶®': '‡¶®‡¶¨‡¶æ‡¶Ø‡¶º‡¶® ‡¶ï‡¶Æ‡¶ø‡¶∂‡¶®',
        '‡¶™‡ßç‡¶∞‡ßã‡¶°‡¶æ‡¶ï‡¶∂‡¶® ‡¶¨‡ßã‡¶®‡¶æ‡¶∏': '‡¶™‡ßç‡¶∞‡ßã‡¶°‡¶æ‡¶ï‡¶∂‡¶® ‡¶¨‡ßã‡¶®‡¶æ‡¶∏',
        '‡¶ï‡¶∞‡ßç‡¶Æ‡¶ö‡¶æ‡¶∞‡ßÄ ‡¶¨‡ßá‡¶§‡¶® (‡¶â‡¶®‡ßç‡¶®‡¶Ø‡¶º‡¶®)': '‡¶ï‡¶∞‡ßç‡¶Æ‡¶ö‡¶æ‡¶∞‡ßÄ ‡¶¨‡ßá‡¶§‡¶® (‡¶â‡¶®‡ßç‡¶®‡¶Ø‡¶º‡¶®)',
        '‡¶â‡ßé‡¶∏‡¶¨ ‡¶¨‡ßã‡¶®‡¶æ‡¶∏ (‡¶â‡¶®‡ßç‡¶®‡¶Ø‡¶º‡¶®)': '‡¶â‡ßé‡¶∏‡¶¨ ‡¶¨‡ßã‡¶®‡¶æ‡¶∏ (‡¶â‡¶®‡ßç‡¶®‡¶Ø‡¶º‡¶®)',
        '‡¶â‡ßé‡¶∏‡¶æ‡¶π ‡¶¨‡ßã‡¶®‡¶æ‡¶∏ (‡¶â‡¶®‡ßç‡¶®‡¶Ø‡¶º‡¶®)': '‡¶â‡ßé‡¶∏‡¶æ‡¶π ‡¶¨‡ßã‡¶®‡¶æ‡¶∏ (‡¶â‡¶®‡ßç‡¶®‡¶Ø‡¶º‡¶®)',
        '‡¶¨‡ßà‡¶∂‡¶æ‡¶ñ‡ßÄ ‡¶≠‡¶æ‡¶§‡¶æ (‡¶â‡¶®‡ßç‡¶®‡¶Ø‡¶º‡¶®)': '‡¶¨‡ßà‡¶∂‡¶æ‡¶ñ‡ßÄ ‡¶≠‡¶æ‡¶§‡¶æ (‡¶â‡¶®‡ßç‡¶®‡¶Ø‡¶º‡¶®)',
        '‡¶°‡¶æ‡¶ï‡ßç‡¶§‡¶æ‡¶∞‡ßÄ ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ‡¶∞ ‡¶´‡¶ø': '‡¶°‡¶æ‡¶ï‡ßç‡¶§‡¶æ‡¶∞‡ßÄ ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ‡¶∞ ‡¶´‡¶ø',
        '‡¶≤‡¶æ‡¶û‡ßç‡¶ö‡¶≠‡¶æ‡¶§‡¶æ (‡¶â‡¶®‡ßç‡¶®‡¶Ø‡¶º‡¶®)': '‡¶≤‡¶æ‡¶û‡ßç‡¶ö‡¶≠‡¶æ‡¶§‡¶æ (‡¶â‡¶®‡ßç‡¶®‡¶Ø‡¶º‡¶®)',
        '‡¶ï‡¶∞‡ßç‡¶Æ‡¶ö‡¶æ‡¶∞‡ßÄ ‡¶¨‡ßá‡¶§‡¶® (‡¶Ö‡¶´‡¶ø‡¶∏)': '‡¶ï‡¶∞‡ßç‡¶Æ‡¶ö‡¶æ‡¶∞‡ßÄ ‡¶¨‡ßá‡¶§‡¶® (‡¶Ö‡¶´‡¶ø‡¶∏)',
        '‡¶â‡ßé‡¶∏‡¶¨ ‡¶¨‡ßã‡¶®‡¶æ‡¶∏ (‡¶Ö‡¶´‡¶ø‡¶∏)': '‡¶â‡ßé‡¶∏‡¶¨ ‡¶¨‡ßã‡¶®‡¶æ‡¶∏ (‡¶Ö‡¶´‡¶ø‡¶∏)',
        '‡¶≤‡¶æ‡¶û‡ßç‡¶ö‡¶≠‡¶æ‡¶§‡¶æ (‡¶Ö‡¶´‡¶ø‡¶∏)': '‡¶≤‡¶æ‡¶û‡ßç‡¶ö‡¶≠‡¶æ‡¶§‡¶æ (‡¶Ö‡¶´‡¶ø‡¶∏)',
        '‡¶â‡ßé‡¶∏‡¶æ‡¶π ‡¶¨‡ßã‡¶®‡¶æ‡¶∏ (‡¶Ö‡¶´‡¶ø‡¶∏)': '‡¶â‡ßé‡¶∏‡¶æ‡¶π ‡¶¨‡ßã‡¶®‡¶æ‡¶∏ (‡¶Ö‡¶´‡¶ø‡¶∏)',
        '‡¶¨‡ßà‡¶∂‡¶æ‡¶ñ‡ßÄ ‡¶≠‡¶æ‡¶§‡¶æ (‡¶Ö‡¶´‡¶ø‡¶∏)': '‡¶¨‡ßà‡¶∂‡¶æ‡¶ñ‡ßÄ ‡¶≠‡¶æ‡¶§‡¶æ (‡¶Ö‡¶´‡¶ø‡¶∏)',
        '‡¶∂‡ßç‡¶∞‡¶æ‡¶®‡ßç‡¶§‡¶ø ‡¶ì ‡¶¨‡¶ø‡¶®‡ßã‡¶¶‡¶® ‡¶≠‡¶æ‡¶§‡¶æ': '‡¶∂‡ßç‡¶∞‡¶æ‡¶®‡ßç‡¶§‡¶ø ‡¶ì ‡¶¨‡¶ø‡¶®‡ßã‡¶¶‡¶® ‡¶≠‡¶æ‡¶§‡¶æ',
        '‡¶ï‡ßç‡¶Ø‡¶æ‡¶∂ ‡¶è‡¶≤‡¶æ‡¶â‡¶®‡ßç‡¶∏': '‡¶ï‡ßç‡¶Ø‡¶æ‡¶∂ ‡¶è‡¶≤‡¶æ‡¶â‡¶®‡ßç‡¶∏',
        '‡¶≠‡ßç‡¶∞‡¶Æ‡¶£ ‡¶ì ‡¶Ø‡¶æ‡¶§‡¶æ‡¶Ø‡¶º‡¶æ‡¶§ ‡¶ñ‡¶∞‡¶ö': '‡¶≠‡ßç‡¶∞‡¶Æ‡¶£ ‡¶ì ‡¶Ø‡¶æ‡¶§‡¶æ‡¶Ø‡¶º‡¶æ‡¶§ ‡¶ñ‡¶∞‡¶ö',
        '‡¶™‡ßá‡¶ü‡¶ø‡¶ï‡ßç‡¶Ø‡¶æ‡¶∂': '‡¶™‡ßá‡¶ü‡¶ø‡¶ï‡ßç‡¶Ø‡¶æ‡¶∂',
        '‡¶ü‡ßá‡¶≤‡¶ø‡¶´‡ßã‡¶® ‡¶¨‡¶ø‡¶≤': '‡¶ü‡ßá‡¶≤‡¶ø‡¶´‡ßã‡¶® ‡¶¨‡¶ø‡¶≤',
        '‡¶Æ‡ßÅ‡¶¶‡ßç‡¶∞‡¶£ ‡¶ì ‡¶Æ‡¶£‡¶ø‡¶π‡¶æ‡¶∞‡¶ø ‡¶ñ‡¶∞‡¶ö': '‡¶Æ‡ßÅ‡¶¶‡ßç‡¶∞‡¶£ ‡¶ì ‡¶Æ‡¶£‡¶ø‡¶π‡¶æ‡¶∞‡¶ø ‡¶ñ‡¶∞‡¶ö',
        '‡¶∞‡¶æ‡¶ú‡¶∏‡ßç‡¶¨ ‡¶ü‡¶ø‡¶ï‡ßá‡¶ü': '‡¶∞‡¶æ‡¶ú‡¶∏‡ßç‡¶¨ ‡¶ü‡¶ø‡¶ï‡ßá‡¶ü',
        '‡¶á‡¶®‡ßç‡¶ü‡¶æ‡¶∞‡¶®‡ßá‡¶ü ‡¶¨‡¶ø‡¶≤': '‡¶á‡¶®‡ßç‡¶ü‡¶æ‡¶∞‡¶®‡ßá‡¶ü ‡¶¨‡¶ø‡¶≤',
        '‡¶∏‡¶æ‡¶ß‡¶æ‡¶∞‡¶£ ‡¶ñ‡¶∞‡¶ö': '‡¶∏‡¶æ‡¶ß‡¶æ‡¶∞‡¶£ ‡¶ñ‡¶∞‡¶ö',
        '‡¶™‡¶§‡ßç‡¶∞‡¶ø‡¶ï‡¶æ ‡¶¨‡¶ø‡¶≤': '‡¶™‡¶§‡ßç‡¶∞‡¶ø‡¶ï‡¶æ ‡¶¨‡¶ø‡¶≤',
        '‡¶¨‡¶ø‡¶¨‡¶ø‡¶ß ‡¶¨‡ßç‡¶Ø‡¶Ø‡¶º': '‡¶¨‡¶ø‡¶¨‡¶ø‡¶ß ‡¶¨‡ßç‡¶Ø‡¶Ø‡¶º',
        '‡¶Ü‡¶∏‡¶¨‡¶æ‡¶¨‡¶™‡¶§‡ßç‡¶∞ ‡¶ï‡ßç‡¶∞‡¶Ø‡¶º': '‡¶Ü‡¶∏‡¶¨‡¶æ‡¶¨‡¶™‡¶§‡ßç‡¶∞ ‡¶ï‡ßç‡¶∞‡¶Ø‡¶º',
        '‡¶¨‡ßã‡¶®‡¶æ‡¶∏ ‡¶ï‡¶Æ‡¶ø‡¶∂‡¶®': '‡¶¨‡ßã‡¶®‡¶æ‡¶∏ ‡¶ï‡¶Æ‡¶ø‡¶∂‡¶®',
        '‡¶°‡¶æ‡¶ï ‡¶ì ‡¶§‡¶æ‡¶∞ ‡¶ñ‡¶∞‡¶ö': '‡¶°‡¶æ‡¶ï ‡¶ì ‡¶§‡¶æ‡¶∞ ‡¶ñ‡¶∞‡¶ö',
        '‡¶Ö‡¶´‡¶ø‡¶∏ ‡¶≠‡¶æ‡¶°‡¶º‡¶æ': '‡¶Ö‡¶´‡¶ø‡¶∏ ‡¶≠‡¶æ‡¶°‡¶º‡¶æ',
        '‡¶ö‡¶ø‡¶ï‡¶ø‡ßé‡¶∏‡¶æ ‡¶ñ‡¶∞‡¶ö (‡¶Ö‡¶´‡¶ø‡¶∏)': '‡¶ö‡¶ø‡¶ï‡¶ø‡ßé‡¶∏‡¶æ ‡¶ñ‡¶∞‡¶ö (‡¶Ö‡¶´‡¶ø‡¶∏)',
        '‡¶¶‡ßà‡¶É‡¶Æ‡¶É‡¶≠‡¶ø‡¶É ‡¶ï‡¶∞‡ßç‡¶Æ‡¶ö‡¶æ‡¶∞‡ßÄ‡¶∞ ‡¶¨‡¶ø‡¶≤': '‡¶¶‡ßà‡¶É‡¶Æ‡¶É‡¶≠‡¶ø‡¶É ‡¶ï‡¶∞‡ßç‡¶Æ‡¶ö‡¶æ‡¶∞‡ßÄ‡¶∞ ‡¶¨‡¶ø‡¶≤'
    };

    let currentEditingId = null;

    function formatDateToDDMMYY(isoDate) {
        const d = new Date(isoDate);
        if (isNaN(d.getTime())) return isoDate;
        const day = String(d.getDate()).padStart(2, '0');
        const month = String(d.getMonth() + 1).padStart(2, '0');
        const year = String(d.getFullYear() % 100).padStart(2, '0');
        return `${day}/${month}/${year}`;
    }

    function parseDateToISO(dateStr) {
        if (!dateStr) return null;
        const parts = dateStr.split('/');
        if (parts.length !== 3) return null;
        
        let day = parts[0];
        let month = parts[1];
        let year = parts[2];

        if (day.length !== 2 || month.length !== 2 || year.length !== 2) {
             return null;
        }
        
        let fullYear = '20' + year;
        const iso = `${fullYear}-${month}-${day}`;
        const d = new Date(iso);
        
        if (isNaN(d.getTime()) || d.getDate() !== parseInt(day) || (d.getMonth() + 1) !== parseInt(month)) {
            return null;
        }
        return iso;
    }

    // --- THIS FUNCTION IS NOW FIXED ---
    function normalizeDigits(str) {
        if (!str) return '';
        const bengaliToEnglish = {
            // Bengali Digits
            '‡ß¶': '0', '‡ßß': '1', '‡ß®': '2', '‡ß©': '3', '‡ß™': '4',
            '‡ß´': '5', '‡ß¨': '6', '‡ß≠': '7', '‡ßÆ': '8', '‡ßØ': '9',
            // Devanagari Digits
            '‡•¶': '0', '‡•ß': '1', '‡•®': '2', '‡•©': '3', '‡•™': '4',
            '‡•´': '5', '‡•¨': '6', '‡•≠': '7', '‡•Æ': '8', '‡•Ø': '9'
        };
        // This regex /[‡ß¶-‡ßØ‡•¶-‡•Ø]/g matches BOTH Bengali and Devanagari digits
        return str.replace(/[‡ß¶-‡ßØ‡•¶-‡•Ø]/g, digit => bengaliToEnglish[digit] || digit);
    }
    // --- END OF FIX ---

    function fetchManpowerName() {
        const codeInput = document.getElementById('manpower-code');
        const nameInput = document.getElementById('manpower-name');
        const code = codeInput.value.trim();
        
        console.log('=== Starting fetchManpowerName ===');
        console.log('Input code:', code);

        if (!code) {
            nameInput.value = '';
            return;
        }

        // --- This function will now correctly normalize codes like '‡ß™‡ß¶‡ß¶‡ßØ‡ßØ‡ßØ‡ßß‡ß©' and '‡•®‡•´‡•¶‡•™' ---
        const normalizedCode = normalizeDigits(code);
        console.log('Normalized code:', normalizedCode);

        console.log('Checking localStorage keys...');
        console.log('Available keys:', Object.keys(localStorage));
        
        let expenseList = null;
        let manpowerList = null;

        try {
            let expenseData = localStorage.getItem('expenseList');
            console.log('expenseList raw data:', expenseData);
            if (expenseData) {
                expenseList = JSON.parse(expenseData);
                console.log('‚úì expenseList parsed:', expenseList);
            }
        } catch (e) {
            console.error('Error parsing expenseList:', e);
        }

        try {
            let manpowerData = localStorage.getItem('manpowerList');
            console.log('manpowerList raw data:', manpowerData);
            if (manpowerData) {
                manpowerList = JSON.parse(manpowerData);
                console.log('‚úì manpowerList parsed:', manpowerList);
            }
        } catch (e) {
            console.error('Error parsing manpowerList:', e);
        }

        if (expenseList && Array.isArray(expenseList)) {
            console.log('Searching in expenseList...');
            const person = expenseList.find(item => {
                const itemCode = normalizeDigits(item.code || item.id || '');
                console.log('Comparing (expenseList):', itemCode, '===', normalizedCode);
                return itemCode === normalizedCode;
            });

            if (person) {
                console.log('‚úì FOUND in expenseList:', person);
                nameInput.value = person.name || '';
                return;
            }
        }

        if (manpowerList && Array.isArray(manpowerList)) {
            console.log('Searching in manpowerList...');
            const person = manpowerList.find(item => {
                const itemCode = normalizeDigits(item.code || item.id || '');
                console.log('Comparing (manpowerList):', itemCode, '===', normalizedCode);
                return itemCode === normalizedCode;
            });

            if (person) {
                console.log('‚úì FOUND in manpowerList:', person);
                nameInput.value = person.name || '';
                return;
            }
        }

        console.log('Searching in manpowerTables...');
        try {
            let tablesData = localStorage.getItem('manpowerTables');
            if (tablesData) {
                let tables = JSON.parse(tablesData);
                console.log('manpowerTables:', tables);

                for (let tableKey in tables) {
                    let items = tables[tableKey];
                    if (Array.isArray(items)) {
                        const person = items.find(item => {
                            const itemCode = normalizeDigits(item.id || item.code || '');
                            console.log(`Comparing (manpowerTables[${tableKey}]):`, itemCode, '===', normalizedCode);
                            return itemCode === normalizedCode;
                        });

                        if (person) {
                            console.log('‚úì FOUND in manpowerTables[' + tableKey + ']:', person);
                            nameInput.value = person.name || '';
                            return;
                        }
                    }
                }
            }
        } catch (e) {
            console.error('Error in manpowerTables search:', e);
        }

        console.log('‚úó Code not found in any list');
        alert('‡¶ï‡ßã‡¶° ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø: ' + code + '\n\n‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá "‡¶ú‡¶®‡¶¨‡¶≤ ‡¶ì ‡¶ñ‡¶∞‡¶ö‡ßá‡¶∞ ‡¶ñ‡¶æ‡¶§" ‡¶™‡¶æ‡¶§‡¶æ‡ßü ‡¶ï‡ßã‡¶°‡¶ü‡¶ø ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®‡•§');
        nameInput.value = '';
    }

    // ================== UPDATED FUNCTION ==================
    function saveCommissionEntries() {
        const dateInput = document.getElementById('expense-date');
        const paymentTypeSelect = document.getElementById('payment-type');
        
        const dateStr = dateInput.value.trim();
        const dateISO = parseDateToISO(dateStr);
        if (!dateISO) {
            alert("‡¶¶‡¶Ø‡¶º‡¶æ ‡¶ï‡¶∞‡ßá ‡¶∏‡¶†‡¶ø‡¶ï ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶® (dd/mm/yy ‡¶´‡¶∞‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ü‡ßá)‡•§");
            return;
        }
        
        // Commission is always 'bank', but we check if a type is selected for validation
        const paymentType = paymentTypeSelect.value;
        if (!paymentType) {
            alert("‡¶¶‡¶Ø‡¶º‡¶æ ‡¶ï‡¶∞‡ßá ‡¶™‡¶∞‡¶ø‡¶∂‡ßã‡¶ß‡ßá‡¶∞ ‡¶ß‡¶∞‡¶® (‡¶¨‡ßç‡¶Ø‡¶æ‡¶Ç‡¶ï/‡¶ï‡ßç‡¶Ø‡¶æ‡¶∂) ‡¶®‡¶ø‡¶∞‡ßç‡¶ß‡¶æ‡¶∞‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§");
            return;
        }

        const manpowerCodeInput = document.getElementById('manpower-code');
        const manpowerNameInput = document.getElementById('manpower-name');
        const manpowerCode = manpowerCodeInput.value.trim();
        const manpowerName = manpowerNameInput.value.trim();

        const amountFirstYear = parseFloat(document.getElementById('amount-first-year').value);
        const billNoFirstYear = document.getElementById('bill-no-first-year').value.trim();
        const billDateFirstYearStr = document.getElementById('bill-date-first-year').value.trim();
        const billDateFirstYear = parseDateToISO(billDateFirstYearStr);

        const amountRenewal = parseFloat(document.getElementById('amount-renewal').value);
        const billNoRenewal = document.getElementById('bill-no-renewal').value.trim();
        const billDateRenewalStr = document.getElementById('bill-date-renewal').value.trim();
        const billDateRenewal = parseDateToISO(billDateRenewalStr);

        let expenses = JSON.parse(localStorage.getItem('pettyCashExpenses') || '[]');
        let savedCount = 0;
        
        // --- THIS IS THE FIX ---
        // Create a unique session ID for this save operation
        const sessionId = Date.now();
        // --- END OF FIX ---

        // Check for edit mode
        if (currentEditingId) {
             alert('‡¶ï‡¶Æ‡¶ø‡¶∂‡¶® ‡¶è‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶ø ‡¶è‡¶°‡¶ø‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá ‡¶®‡¶æ‡•§ ‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®‡•§');
             return;
        }

        if (!isNaN(amountFirstYear) && amountFirstYear > 0) {
            const entry = {
                id: sessionId + 1, // Unique ID
                sessionId: sessionId, // Link to this session
                date: dateISO,
                expenseColumn: EXPENSE_MAPPING['‡ßß‡¶Æ ‡¶¨‡¶∞‡ßç‡¶∑ ‡¶ï‡¶Æ‡¶ø‡¶∂‡¶®'],
                amount: amountFirstYear,
                details: '‡ßß‡¶Æ ‡¶¨‡¶∞‡ßç‡¶∑ ‡¶ï‡¶Æ‡¶ø‡¶∂‡¶®',
                paymentType: 'bank' // Commission is always bank
            };

            if (manpowerCode && manpowerName) {
                entry.manpowerCode = manpowerCode;
                entry.manpowerName = manpowerName;
                entry.details = `‡ßß‡¶Æ ‡¶¨‡¶∞‡ßç‡¶∑ ‡¶ï‡¶Æ‡¶ø‡¶∂‡¶® (${manpowerName})`;
            }

            if (billNoFirstYear) entry.billNo = billNoFirstYear;
            if (billDateFirstYear) entry.billDate = billDateFirstYear;

            expenses.push(entry);
            savedCount++;
        }

        if (!isNaN(amountRenewal) && amountRenewal > 0) {
            const entry = {
                id: sessionId + 2, // Unique ID
                sessionId: sessionId, // Link to this session
                date: dateISO,
                expenseColumn: EXPENSE_MAPPING['‡¶®‡¶¨‡¶æ‡¶Ø‡¶º‡¶® ‡¶ï‡¶Æ‡¶ø‡¶∂‡¶®'],
                amount: amountRenewal,
                details: '‡¶®‡¶¨‡¶æ‡¶Ø‡¶º‡¶® ‡¶ï‡¶Æ‡¶ø‡¶∂‡¶®',
                paymentType: 'bank' // Commission is always bank
            };

            if (manpowerCode && manpowerName) {
                entry.manpowerCode = manpowerCode;
                entry.manpowerName = manpowerName;
                entry.details = `‡¶®‡¶¨‡¶æ‡¶Ø‡¶º‡¶® ‡¶ï‡¶Æ‡¶ø‡¶∂‡¶® (${manpowerName})`;
            }

            if (billNoRenewal) entry.billNo = billNoRenewal;
            if (billDateRenewal) entry.billDate = billDateRenewal;

            expenses.push(entry);
            savedCount++;
        }

        if (savedCount === 0) {
            alert("‡¶¶‡¶Ø‡¶º‡¶æ ‡¶ï‡¶∞‡ßá ‡¶Ö‡¶®‡ßç‡¶§‡¶§ ‡¶è‡¶ï‡¶ü‡¶ø ‡¶ï‡¶Æ‡¶ø‡¶∂‡¶®‡ßá‡¶∞ ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®‡•§");
            return;
        }

        localStorage.setItem('pettyCashExpenses', JSON.stringify(expenses));
        
        let message = `${savedCount}‡¶ü‡¶ø ‡¶è‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶ø ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!\n`;
        if (!isNaN(amountFirstYear) && amountFirstYear > 0) {
            message += `\n‡ßß‡¶Æ ‡¶¨‡¶∞‡ßç‡¶∑ ‡¶ï‡¶Æ‡¶ø‡¶∂‡¶®: ${amountFirstYear} ‡¶ü‡¶æ‡¶ï‡¶æ`;
        }
        if (!isNaN(amountRenewal) && amountRenewal > 0) {
            message += `\n‡¶®‡¶¨‡¶æ‡¶Ø‡¶º‡¶® ‡¶ï‡¶Æ‡¶ø‡¶∂‡¶®: ${amountRenewal} ‡¶ü‡¶æ‡¶ï‡¶æ`;
        }
        message += `\n‡¶Æ‡¶æ‡¶ß‡ßç‡¶Ø‡¶Æ: ‡¶¨‡ßç‡¶Ø‡¶æ‡¶Ç‡¶ï`;
        
        alert(message);
        
        document.getElementById('amount-first-year').value = "";
        document.getElementById('bill-no-first-year').value = "";
        document.getElementById('bill-date-first-year').value = "";
        document.getElementById('amount-renewal').value = "";
        document.getElementById('bill-no-renewal').value = "";
        document.getElementById('bill-date-renewal').value = "";
        manpowerCodeInput.value = "";
        manpowerNameInput.value = "";
        
        displayExpenseLog();
    }
    // ================== END OF UPDATE ==================

    // data entry.html ‡¶´‡¶æ‡¶á‡¶≤‡ßá‡¶∞ <script> ‡¶ü‡ßç‡¶Ø‡¶æ‡¶ó‡ßá‡¶∞ ‡¶≠‡ßá‡¶§‡¶∞‡ßá‡¶∞ ‡¶ï‡ßã‡¶°
    // ========== ‡¶è‡¶á ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®‡¶ü‡¶ø ‡¶∏‡¶Æ‡¶æ‡¶ß‡¶æ‡¶® ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá (FIXED) ==========

function saveEntry(selectElementId, amountInputId, forcedPaymentType = null) {
    const dateInput = document.getElementById('expense-date');
    const selectElement = document.getElementById(selectElementId);
    const amountInput = document.getElementById(amountInputId);
    const paymentTypeSelect = document.getElementById('payment-type');

    const dateStr = dateInput.value.trim();
    const dateISO = parseDateToISO(dateStr);
    if (!dateISO) {
        alert("‡¶¶‡¶Ø‡¶º‡¶æ ‡¶ï‡¶∞‡ßá ‡¶∏‡¶†‡¶ø‡¶ï ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶® (dd/mm/yy ‡¶´‡¶∞‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ü‡ßá)‡•§");
        return;
    }
    const paymentType = forcedPaymentType || paymentTypeSelect.value;
    const amount = parseFloat(amountInput.value);
    let dropdownValue;

    if (!paymentType) {
        alert("‡¶¶‡¶Ø‡¶º‡¶æ ‡¶ï‡¶∞‡ßá ‡¶™‡¶∞‡¶ø‡¶∂‡ßã‡¶ß‡ßá‡¶∞ ‡¶ß‡¶∞‡¶® (‡¶¨‡ßç‡¶Ø‡¶æ‡¶Ç‡¶ï/‡¶ï‡ßç‡¶Ø‡¶æ‡¶∂) ‡¶®‡¶ø‡¶∞‡ßç‡¶ß‡¶æ‡¶∞‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§");
        return;
    }

    if (selectElement.tagName === 'SELECT') {
        dropdownValue = selectElement.value;
    } else if (selectElement.tagName === 'INPUT' && selectElement.type === 'hidden') {
        dropdownValue = selectElement.value;
    } else {
        alert("‡¶§‡ßç‡¶∞‡ßÅ‡¶ü‡¶ø: ‡¶®‡¶ø‡¶∞‡ßç‡¶ß‡¶æ‡¶∞‡¶£ ‡¶â‡¶™‡¶æ‡¶¶‡¶æ‡¶® ‡¶ñ‡ßÅ‡¶Å‡¶ú‡ßá ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø‡•§");
        return;
    }

    if (dropdownValue === "" || !(dropdownValue in EXPENSE_MAPPING)) {
        alert("‡¶¶‡¶Ø‡¶º‡¶æ ‡¶ï‡¶∞‡ßá ‡¶ñ‡¶∞‡¶ö‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡¶ï‡¶æ‡¶∞ ‡¶®‡¶ø‡¶∞‡ßç‡¶ß‡¶æ‡¶∞‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶¨‡¶æ ‡¶Æ‡¶æ‡¶®‡¶ö‡¶ø‡¶§‡ßç‡¶∞‡ßá ‡¶Æ‡¶æ‡¶® ‡¶§‡ßç‡¶∞‡ßÅ‡¶ü‡¶ø‡¶™‡ßÇ‡¶∞‡ßç‡¶£‡•§");
        return;
    }

    if (isNaN(amount) || amount <= 0) {
        alert("‡¶¶‡¶Ø‡¶º‡¶æ ‡¶ï‡¶∞‡ßá ‡¶∏‡¶†‡¶ø‡¶ï ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®‡•§");
        return;
    }

    const manpowerCodeInput = document.getElementById('manpower-code');
    const manpowerNameInput = document.getElementById('manpower-name');
    const manpowerCode = manpowerCodeInput.value.trim();
    const manpowerName = manpowerNameInput.value.trim();

    // ================== ‡¶Æ‡ßÇ‡¶≤ ‡¶∏‡¶Æ‡¶æ‡¶ß‡¶æ‡¶® (FIXED) ==================
    // "‡¶™‡ßá‡¶ü‡¶ø‡¶ï‡ßç‡¶Ø‡¶æ‡¶∂" ‡¶è‡¶ï‡¶ü‡¶ø ‡¶¨‡¶ø‡¶∂‡ßá‡¶∑ ‡¶è‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶ø‡•§ ‡¶è‡¶ü‡¶ø "‡¶ï‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶æ" ‡¶ï‡¶≤‡¶æ‡¶Æ‡ßá ‡¶Ø‡¶æ‡¶¨‡ßá‡•§
    
    let expenseStatementColumn = EXPENSE_MAPPING[dropdownValue];
    
    if (dropdownValue === '‡¶™‡ßá‡¶ü‡¶ø‡¶ï‡ßç‡¶Ø‡¶æ‡¶∂') {
        expenseStatementColumn = '‡¶ï‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶æ'; // "‡¶™‡ßá‡¶ü‡¶ø‡¶ï‡ßç‡¶Ø‡¶æ‡¶∂"-‡¶ï‡ßá "‡¶ï‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶æ" ‡¶ï‡¶≤‡¶æ‡¶Æ ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨‡ßá ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡ßÅ‡¶®
    }
    // ================== ‡¶∂‡ßá‡¶∑ ==================
    
    const entry = {
        id: currentEditingId || Date.now(),
        date: dateISO,
        expenseColumn: expenseStatementColumn, // ‡¶è‡¶ü‡¶ø ‡¶è‡¶ñ‡¶® "‡¶ï‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶æ" ‡¶π‡¶¨‡ßá ‡¶Ø‡¶¶‡¶ø "‡¶™‡ßá‡¶ü‡¶ø‡¶ï‡ßç‡¶Ø‡¶æ‡¶∂" ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü
        amount: amount,
        details: dropdownValue,
        paymentType: paymentType
    };

    if (manpowerCode && manpowerName) {
        entry.manpowerCode = manpowerCode;
        entry.manpowerName = manpowerName;
        entry.details = `${dropdownValue} (${manpowerName})`;
    }

    // ********** ‡¶°‡¶æ‡¶¨‡¶≤ ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡¶ø‡¶Ç ‡¶è‡¶∞ ‡¶ï‡¶æ‡¶∞‡¶£‡¶ü‡¶ø ‡¶è‡¶ñ‡¶æ‡¶® ‡¶•‡ßá‡¶ï‡ßá ‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡¶æ ‡¶π‡¶≤‡ßã **********
    /* if (dropdownValue === '‡¶™‡ßá‡¶ü‡¶ø‡¶ï‡ßç‡¶Ø‡¶æ‡¶∂') {
        entry.contraAmount = amount;
    }
    */
    // ***************************************************************

    let expenses = JSON.parse(localStorage.getItem('pettyCashExpenses') || '[]');
    
    let actionMsg = '‡¶∏‡ßá‡¶≠';
    if (currentEditingId) {
        const index = expenses.findIndex(e => e.id === currentEditingId);
        if (index !== -1) {
            expenses[index] = entry;
            actionMsg = '‡¶Ü‡¶™‡¶°‡ßá‡¶ü';
        } else {
            // Failsafe: if ID not found, just add as new entry
            expenses.push(entry);
        }
        currentEditingId = null; // Clear editing ID
    } else {
        expenses.push(entry);
    }
    localStorage.setItem('pettyCashExpenses', JSON.stringify(expenses));

    console.log(`Saving Entry: ${expenseStatementColumn}, Amount: ${amount}, Type: ${paymentType}`);
    alert(`‡¶è‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶ø ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ${actionMsg} ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!\n‡¶ñ‡¶∞‡¶ö: ${entry.details}\n‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£: ${amount} ‡¶ü‡¶æ‡¶ï‡¶æ\n‡¶Æ‡¶æ‡¶ß‡ßç‡¶Ø‡¶Æ: ${paymentType === 'bank' ? '‡¶¨‡ßç‡¶Ø‡¶æ‡¶Ç‡¶ï' : '‡¶ï‡ßç‡¶Ø‡¶æ‡¶∂'}`);
    
    if (selectElement.tagName === 'SELECT') {
        selectElement.selectedIndex = 0;
    }
    amountInput.value = "";
    manpowerCodeInput.value = "";
    manpowerNameInput.value = "";
    
    // Reset commission fields just in case
    document.getElementById('amount-first-year').value = "";
    document.getElementById('bill-no-first-year').value = "";
    document.getElementById('bill-date-first-year').value = "";
    document.getElementById('amount-renewal').value = "";
    document.getElementById('bill-no-renewal').value = "";
    document.getElementById('bill-date-renewal').value = "";

    displayExpenseLog();
}

    function removeEntry(id) {
        const entryId = parseInt(id);
        if (isNaN(entryId) || entryId <= 0) {
             alert("‡¶§‡ßç‡¶∞‡ßÅ‡¶ü‡¶ø: ‡¶¨‡ßà‡¶ß ‡¶è‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶ø ‡¶Ü‡¶á‡¶°‡¶ø ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø‡•§");
             return;
        }

        if (!confirm("‡¶Ü‡¶™‡¶®‡¶ø ‡¶ï‡¶ø ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶Ø‡ßá ‡¶Ü‡¶™‡¶®‡¶ø ‡¶è‡¶á ‡¶è‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶ø‡¶ü‡¶ø ‡¶Æ‡ßÅ‡¶õ‡¶§‡ßá ‡¶ö‡¶æ‡¶®?")) {
            return;
        }
        
        let expenses = JSON.parse(localStorage.getItem('pettyCashExpenses') || '[]');
        const updatedExpenses = expenses.filter(entry => entry.id !== entryId);
        localStorage.setItem('pettyCashExpenses', JSON.stringify(updatedExpenses));
        alert("‡¶è‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶ø ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§");
        displayExpenseLog();
    }

    function clearAllEntries() {
        if (confirm("‡¶Ü‡¶™‡¶®‡¶ø ‡¶ï‡¶ø ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶Ø‡ßá ‡¶∏‡¶¨ ‡¶è‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶ø ‡¶Æ‡ßÅ‡¶õ‡¶§‡ßá ‡¶ö‡¶æ‡¶®? ‡¶è‡¶ü‡¶ø ‡¶™‡ßÅ‡¶®‡¶∞‡ßÅ‡¶¶‡ßç‡¶ß‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá ‡¶®‡¶æ‡•§")) {
            localStorage.removeItem('pettyCashExpenses');
            displayExpenseLog();
            alert("‡¶∏‡¶¨ ‡¶è‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶ø ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§");
        }
    }

    function editEntry(id) {
        let expenses = JSON.parse(localStorage.getItem('pettyCashExpenses') || '[]');
        const entry = expenses.find(e => e.id === id);
        if (!entry) {
            alert("‡¶è‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶ø ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø‡•§");
            return;
        }

        const baseDetails = entry.details.split(' (')[0];
        
        // ‡¶ï‡¶Æ‡¶ø‡¶∂‡¶® ‡¶è‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶ø ‡¶è‡¶°‡¶ø‡¶ü ‡¶®‡¶ø‡¶∑‡¶ø‡¶¶‡ßç‡¶ß ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá
        if (baseDetails === '‡ßß‡¶Æ ‡¶¨‡¶∞‡ßç‡¶∑ ‡¶ï‡¶Æ‡¶ø‡¶∂‡¶®' || baseDetails === '‡¶®‡¶¨‡¶æ‡¶Ø‡¶º‡¶® ‡¶ï‡¶Æ‡¶ø‡¶∂‡¶®') {
            alert('‡¶ï‡¶Æ‡¶ø‡¶∂‡¶® ‡¶è‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶ø ‡¶è‡¶°‡¶ø‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá ‡¶®‡¶æ‡•§ ‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®‡•§');
            return; // ‡¶è‡¶°‡¶ø‡¶ü ‡¶®‡¶æ ‡¶ï‡¶∞‡ßá ‡¶´‡¶ø‡¶∞‡ßá ‡¶Ø‡¶æ‡¶®, currentEditingId ‡¶∏‡ßá‡¶ü ‡¶®‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®
        }

        // --- Clear all fields first to avoid old data lingering ---
        document.getElementById('office-expenses').selectedIndex = 0;
        document.getElementById('amount-office').value = '';
        document.getElementById('official-expenses').selectedIndex = 0;
        document.getElementById('amount-official').value = '';
        document.getElementById('development-staff').selectedIndex = 0;
        document.getElementById('amount-staff').value = '';
        document.getElementById('amount-first-year').value = '';
        document.getElementById('bill-no-first-year').value = '';
        document.getElementById('bill-date-first-year').value = '';
        document.getElementById('amount-renewal').value = '';
        document.getElementById('bill-no-renewal').value = '';
        document.getElementById('bill-date-renewal').value = '';
        // --- End of clear ---

        currentEditingId = entry.id;

        document.getElementById('expense-date').value = formatDateToDDMMYY(entry.date);
        document.getElementById('payment-type').value = entry.paymentType;

        document.getElementById('manpower-code').value = entry.manpowerCode || '';
        document.getElementById('manpower-name').value = entry.manpowerName || '';

        if (['‡¶™‡ßç‡¶∞‡ßã‡¶°‡¶æ‡¶ï‡¶∂‡¶® ‡¶¨‡ßã‡¶®‡¶æ‡¶∏', '‡¶ï‡¶∞‡ßç‡¶Æ‡¶ö‡¶æ‡¶∞‡ßÄ ‡¶¨‡ßá‡¶§‡¶® (‡¶â‡¶®‡ßç‡¶®‡¶Ø‡¶º‡¶®)', '‡¶â‡ßé‡¶∏‡¶¨ ‡¶¨‡ßã‡¶®‡¶æ‡¶∏ (‡¶â‡¶®‡ßç‡¶®‡¶Ø‡¶º‡¶®)', '‡¶â‡ßé‡¶∏‡¶æ‡¶π ‡¶¨‡ßã‡¶®‡¶æ‡¶∏ (‡¶â‡¶®‡ßç‡¶®‡¶Ø‡¶º‡¶®)', '‡¶¨‡ßà‡¶∂‡¶æ‡¶ñ‡ßÄ ‡¶≠‡¶æ‡¶§‡¶æ (‡¶â‡¶®‡ßç‡¶®‡¶Ø‡¶º‡¶®)', '‡¶°‡¶æ‡¶ï‡ßç‡¶§‡¶æ‡¶∞‡ßÄ ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ‡¶∞ ‡¶´‡¶ø', '‡¶≤‡¶æ‡¶û‡ßç‡¶ö‡¶≠‡¶æ‡¶§‡¶æ (‡¶â‡¶®‡ßç‡¶®‡¶Ø‡¶º‡¶®)', '‡¶¨‡ßã‡¶®‡¶æ‡¶∏ ‡¶ï‡¶Æ‡¶ø‡¶∂‡¶®'].includes(baseDetails)) {
            document.getElementById('development-staff').value = baseDetails;
            document.getElementById('amount-staff').value = entry.amount;
        } else if (['‡¶ï‡¶∞‡ßç‡¶Æ‡¶ö‡¶æ‡¶∞‡ßÄ ‡¶¨‡ßá‡¶§‡¶® (‡¶Ö‡¶´‡¶ø‡¶∏)', '‡¶â‡ßé‡¶∏‡¶¨ ‡¶¨‡ßã‡¶®‡¶æ‡¶∏ (‡¶Ö‡¶´‡¶ø‡¶∏)', '‡¶≤‡¶æ‡¶û‡ßç‡¶ö‡¶≠‡¶æ‡¶§‡¶æ (‡¶Ö‡¶´‡¶ø‡¶∏)', '‡¶â‡ßé‡¶∏‡¶æ‡¶π ‡¶¨‡ßã‡¶®‡¶æ‡¶∏ (‡¶Ö‡¶´‡¶ø‡¶∏)', '‡¶¨‡ßà‡¶∂‡¶æ‡¶ñ‡ßÄ ‡¶≠‡¶æ‡¶§‡¶æ (‡¶Ö‡¶´‡¶ø‡¶∏)', '‡¶∂‡ßç‡¶∞‡¶æ‡¶®‡ßç‡¶§‡¶ø ‡¶ì ‡¶¨‡¶ø‡¶®‡ßã‡¶¶‡¶® ‡¶≠‡¶æ‡¶§‡¶æ', '‡¶ï‡ßç‡¶Ø‡¶æ‡¶∂ ‡¶è‡¶≤‡¶æ‡¶â‡¶®‡ßç‡¶∏', '‡¶≠‡ßç‡¶∞‡¶Æ‡¶£ ‡¶ì ‡¶Ø‡¶æ‡¶§‡¶æ‡¶Ø‡¶º‡¶æ‡¶§ ‡¶ñ‡¶∞‡¶ö', '‡¶ö‡¶ø‡¶ï‡¶ø‡ßé‡¶∏‡¶æ ‡¶ñ‡¶∞‡¶ö (‡¶Ö‡¶´‡¶ø‡¶∏)'].includes(baseDetails)) {
            document.getElementById('office-expenses').value = baseDetails;
            document.getElementById('amount-office').value = entry.amount;
        } else if (['‡¶™‡ßá‡¶ü‡¶ø‡¶ï‡ßç‡¶Ø‡¶æ‡¶∂', '‡¶ü‡ßá‡¶≤‡¶ø‡¶´‡ßã‡¶® ‡¶¨‡¶ø‡¶≤', '‡¶Æ‡ßÅ‡¶¶‡ßç‡¶∞‡¶£ ‡¶ì ‡¶Æ‡¶£‡¶ø‡¶π‡¶æ‡¶∞‡¶ø ‡¶ñ‡¶∞‡¶ö', '‡¶∞‡¶æ‡¶ú‡¶∏‡ßç‡¶¨ ‡¶ü‡¶ø‡¶ï‡ßá‡¶ü', '‡¶á‡¶®‡ßç‡¶ü‡¶æ‡¶∞‡¶®‡ßá‡¶ü ‡¶¨‡¶ø‡¶≤', '‡¶∏‡¶æ‡¶ß‡¶æ‡¶∞‡¶£ ‡¶ñ‡¶∞‡¶ö', '‡¶™‡¶§‡ßç‡¶∞‡¶ø‡¶ï‡¶æ ‡¶¨‡¶ø‡¶≤', '‡¶¨‡¶ø‡¶¨‡¶ø‡¶ß ‡¶¨‡ßç‡¶Ø‡¶Ø‡¶º', '‡¶Ü‡¶∏‡¶¨‡¶æ‡¶¨‡¶™‡¶§‡ßç‡¶∞ ‡¶ï‡ßç‡¶∞‡¶Ø‡¶º','‡¶°‡¶æ‡¶ï ‡¶ì ‡¶§‡¶æ‡¶∞ ‡¶ñ‡¶∞‡¶ö', '‡¶Ö‡¶´‡¶ø‡¶∏ ‡¶≠‡¶æ‡¶°‡¶º‡¶æ','‡¶¶‡ßà‡¶É‡¶Æ‡¶É‡¶≠‡¶ø‡¶É ‡¶ï‡¶∞‡ßç‡¶Æ‡¶ö‡¶æ‡¶∞‡ßÄ‡¶∞ ‡¶¨‡¶ø‡¶≤'].includes(baseDetails)) {
            document.getElementById('official-expenses').value = baseDetails;
            document.getElementById('amount-official').value = entry.amount;
        }

        alert("‡¶è‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶ø ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§ ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶ï‡¶∞‡ßá '‡¶∏‡ßá‡¶≠' ‡¶¨‡¶æ '‡¶∏‡ßá‡¶≠ ‡¶è‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶ø' ‡¶¨‡¶æ‡¶ü‡¶®‡ßá ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®‡•§");
        window.scrollTo(0, 0); // Scroll to top to see the form
    }

    function displayExpenseLog(searchTerm = '') {
        const logList = document.getElementById('expense-log');
        let expenses = JSON.parse(localStorage.getItem('pettyCashExpenses') || '[]');
       
        logList.innerHTML = '';
       
        if (expenses.length === 0) {
            logList.innerHTML = '<li class="log-empty-message">‡¶ï‡ßã‡¶®‡ßã ‡¶è‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶ø ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡¶®‡¶ø‡•§</li>';
            return;
        }
       
        expenses.sort((a, b) => new Date(b.date) - new Date(a.date) || b.id - a.id);
       
        const normalizedSearch = normalizeDigits(searchTerm.toLowerCase());

        let filteredExpenses = expenses.filter(entry => {
            const dateStr = formatDateToDDMMYY(entry.date);
            
            let displayDetails = entry.details;
            // No need to add manpower name here, it's already in entry.details if present
            
            let billInfo = '';
            if (entry.billNo || entry.billDate) {
                billInfo = ` | ‡¶¨‡¶ø‡¶≤: ${entry.billNo || ''}${entry.billDate ? ` (${formatDateToDDMMYY(entry.billDate)})` : ''}`;
            }
            const paymentTypeLabel = entry.paymentType === 'bank' ? '‡¶¨‡ßç‡¶Ø‡¶æ‡¶Ç‡¶ï' : '‡¶ï‡ßç‡¶Ø‡¶æ‡¶∂';
            const amountStr = entry.amount.toFixed(2) + ' ‡¶ü‡¶æ‡¶ï‡¶æ';

            // Construct a searchable string
            const fullStr = [
                dateStr,
                displayDetails,
                entry.manpowerCode,
                entry.manpowerName,
                billInfo,
                paymentTypeLabel,
                entry.amount.toString()
            ].join(' ').toLowerCase();

            const normalizedFullStr = normalizeDigits(fullStr);
            
            return normalizedFullStr.includes(normalizedSearch);
        });
       
        if (filteredExpenses.length === 0) {
            logList.innerHTML = '<li class="log-empty-message">‡¶ï‡ßã‡¶®‡ßã ‡¶Æ‡¶ø‡¶≤ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø‡•§</li>';
            return;
        }

        filteredExpenses.forEach((entry, index) => {
            const serialNumber = index + 1;
            const listItem = document.createElement('li');
            const paymentTypeLabel = entry.paymentType === 'bank' ? '‡¶¨‡ßç‡¶Ø‡¶æ‡¶Ç‡¶ï' : '‡¶ï‡ßç‡¶Ø‡¶æ‡¶∂';
            let displayDetails = entry.details;
           
            let billInfo = '';
            if (entry.billNo || entry.billDate) {
                billInfo = ` | ‡¶¨‡¶ø‡¶≤: ${entry.billNo || ''}${entry.billDate ? ` (${formatDateToDDMMYY(entry.billDate)})` : ''}`;
            }
            listItem.innerHTML = `
                <span class="log-details">
                    <strong>${serialNumber}.</strong> ${formatDateToDDMMYY(entry.date)} | ${displayDetails}${billInfo} (${paymentTypeLabel}): <strong>${entry.amount.toFixed(2)} ‡¶ü‡¶æ‡¶ï‡¶æ</strong>
                </span>
                <div>
                    <button class="edit-btn" onclick="editEntry(${entry.id})">‡¶è‡¶°‡¶ø‡¶ü</button>
                    <button class="remove-btn" onclick="removeEntry(${entry.id})">‡¶Æ‡ßÅ‡¶õ‡ßÅ‡¶®</button>
                </div>
            `;
            logList.appendChild(listItem);
        });
    }

    document.addEventListener('DOMContentLoaded', function() {
        const today = new Date();
        const dd = String(today.getDate()).padStart(2, '0');
        const mm = String(today.getMonth() + 1).padStart(2, '0');
        const yy = String(today.getFullYear() % 100).padStart(2, '0');
        
        const dateInput = document.getElementById('expense-date');
        if (!dateInput.value) { // Only set if not already set (e.g., by flatpickr)
             dateInput.value = `${dd}/${mm}/${yy}`;
        }
        
        document.getElementById('payment-type').selectedIndex = 0;
        displayExpenseLog();

        document.getElementById('search-log').addEventListener('input', function() {
            displayExpenseLog(this.value);
        });

        flatpickr("#expense-date", {
            dateFormat: "d/m/y",
            allowInput: true,
            defaultDate: "today"
        });
        flatpickr("#bill-date-first-year", {
            dateFormat: "d/m/y",
            allowInput: true
        });
        flatpickr("#bill-date-renewal", {
            dateFormat: "d/m/y",
            allowInput: true
        });

        document.getElementById('manpower-code').addEventListener('keypress', function(event) {
            if (event.key === 'Enter') {
                event.preventDefault(); // Stop form submission
                fetchManpowerName();
            }
        });
    });
    </script>
</body>
</html>